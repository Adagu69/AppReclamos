<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<!-- fragments/navbar.html -->
<nav th:fragment="navbar" class="app-header navbar navbar-expand bg-body">
    <div class="container-fluid">
        <!-- Lado Izquierdo de la Navbar -->
        <ul class="navbar-nav">
            <li class="nav-item">
                <!-- Icono para mostrar/ocultar el sidebar -->
                <a class="nav-link" data-lte-toggle="sidebar" href="#" role="button">
                    <i class="fas fa-bars"></i>
                </a>
            </li>
            <li class="nav-item d-none d-sm-inline-block">
                <a th:href="@{/}" class="nav-link">Inicio</a>
            </li>
        </ul>

        <!-- Lado Derecho de la Navbar -->
        <!-- La clase 'ms-auto' empuja este bloque completamente a la derecha -->
        <ul class="navbar-nav ms-auto">

            <!-- (Opcional) Búsqueda -->
            <li class="nav-item">
                <a class="nav-link" data-widget="navbar-search" href="#" role="button">
                    <i class="fas fa-search"></i>
                </a>
                <div class="navbar-search-block">
                    <!-- Formulario de búsqueda que aparece al hacer clic -->
                </div>
            </li>

            <!-- (Opcional) Pantalla Completa -->
            <li class="nav-item">
                <a class="nav-link" href="#" data-lte-toggle="fullscreen">
                    <i class="fas fa-expand-arrows-alt"></i>
                </a>
            </li>

            <!-- Menú de Usuario -->
            <li class="nav-item dropdown user-menu">
                <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
                    <!--
                      CAMBIO CLAVE:
                      Se reemplazó la etiqueta <img> por un icono <i> de Font Awesome.
                      'fa-lg' lo hace un poco más grande y 'me-2' añade un pequeño margen.
                    -->
                    <i class="fas fa-user-circle fa-lg me-2"></i>
                    <span class="d-none d-md-inline" th:text="${#authentication.name}">Usuario</span>
                </a>
                <ul class="dropdown-menu dropdown-menu-lg dropdown-menu-end">
                    <!-- Cabecera del menú desplegable con un diseño más atractivo -->
                    <li class="user-header bg-primary text-white">
                        <i class="fas fa-user-circle fa-5x"></i>
                        <p>
                            <span th:text="${#authentication.name}">Usuario</span>
                            <!-- Muestra el primer rol del usuario -->
                            <small th:if="${!#lists.isEmpty(#authentication.principal.authorities)}"
                                   th:text="${#authentication.principal.authorities[0]}">Rol de Usuario</small>
                        </p>
                    </li>
                    <!-- Pie del menú con los botones de Perfil y Cerrar Sesión -->
                    <li class="user-footer d-flex justify-content-between">
                        <a href="#" class="btn btn-default btn-flat">Perfil</a>
                        <a th:href="@{/logout}" class="btn btn-default btn-flat">Cerrar sesión</a>
                    </li>
                </ul>
            </li>
        </ul>
    </div>
</nav>
</body>
</html>